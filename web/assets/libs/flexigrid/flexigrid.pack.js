(function(A){A.addFlex=function(N,P){if(N.grid)return false;P=A.extend({height:200,width:"auto",striped:true,novStripe:false,minWidth:30,minHeight:100,resizable:true,url:false,method:"POST",dataType:"xml",errorMsg:"Connection Error",errorHandler:null,usePager:false,nowrap:true,page:1,total:1,useRp:true,limit:15,limitOptions:[10,15,20,25,50,100],startPage:1,title:false,fitColumns:true,rowNumbers:true,searchText:"search",showSearchBar:false,pageStat:"Displaying {from} to {to} of {total} items",processingMsg:"Processing, please wait ...",quickSearchText:"Quick Search",clearText:"Clear",pageText:"Page{currentPage} of {totalPage}",refreshText:"Refersh",noFoundDataMsg:"No items",minColToggle:1,showToggleBtn:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,disableClearSearchButton:false,onToggleCol:false,onChangeSort:false,onSuccess:false,onSubmit:false,onLoad:false},P);var loaded=false,ie9=false,padding=11;if($.browser.msie&&parseInt($.browser.version,10)==9)ie9=true;A(N).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr("width");var S={hset:{},rePosDrag:function(){var Z=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0)Z-=Math.floor(P.cgwidth/2);A(S.cDrag).css({top:S.hDiv.offsetTop+1});var Y=this.cdpad;A("div",S.cDrag).hide();A("thead tr:first th:visible",this.hDiv).each(function(){var c=A("thead tr:first th:visible",S.hDiv).index(this),b=parseInt(A("div",this).width()),a=b;if(Z==0)Z-=Math.floor(P.cgwidth/2);b=b+Z+Y;if(isNaN(b))b=0;A("div:eq("+c+")",S.cDrag).css({left:b+"px"}).show();Z=b})},fixHeight:function(Z){if(!Z)Z=A(S.bDiv).height();var a=A(this.hDiv).height();A("div",this.cDrag).each(function(){A(this).height(Z+a)});A(S.block).css({height:Z,marginBottom:(Z*-1)});var Y=S.bDiv.offsetTop+Z;if(P.height!="auto"&&P.resizable)Y=S.vDiv.offsetTop;A(S.rDiv).css({height:Y})},ie9Fix:function(){if($(".bDiv").height()!=$(".bDiv table").height()&&P.height=='auto')$(".bDiv").css({height:$(".bDiv table").height()+18})},dragStart:function(c,b,a){if(c=="colresize"){A(S.nDiv).hide();A(S.nBtn).hide();var d=A("div",this.cDrag).index(a),Y=A("th:visible div:eq("+d+")",this.hDiv).width();A(a).addClass("dragging").siblings().hide();A(a).prev().addClass("dragging").show();this.colresize={startX:b.pageX,ol:parseInt(a.style.left),ow:Y,n:d};A("body").css("cursor","col-resize")}else if(c=="vresize"){var Z=false;A("body").css("cursor","row-resize");if(a){Z=true;A("body").css("cursor","col-resize")}this.vresize={h:P.height,sy:b.pageY,w:P.width,sx:b.pageX,hgo:Z}}else if(c=="colMove"){A(S.nDiv).hide();A(S.nBtn).hide();this.hset=A(this.hDiv).offset();this.hset.right=this.hset.left+A("table",this.hDiv).width();this.hset.bottom=this.hset.top+A("table",this.hDiv).height();this.dcol=a;this.dcoln=A("th",this.hDiv).index(a);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=a.innerHTML;if(A.browser.msie)this.colCopy.className="colCopy ie";A(this.colCopy).css({position:"absolute",float:"left",display:"none",textAlign:a.align});A("body").append(this.colCopy);A(this.cDrag).hide()}A("body").noSelect()},dragMove:function(c){if(this.colresize){var Z=this.colresize.n,j=c.pageX-this.colresize.startX,d=this.colresize.ol+j,b=this.colresize.ow+j;if(b>P.minWidth){A("div:eq("+Z+")",this.cDrag).css("left",d);this.colresize.nw=b}}else if(this.vresize){var k=this.vresize,g=c.pageY,j=g-k.sy;if(!P.defwidth)P.defwidth=P.width;if(P.width!="auto"&&!P.nohresize&&k.hgo){var h=c.pageX,a=h-k.sx,Y=k.w+a;if(Y>P.defwidth){this.gDiv.style.width=Y+"px";P.width=Y}}var f=k.h+j;if((f>P.minHeight||P.height<P.minHeight)&&!k.hgo){this.bDiv.style.height=f+"px";P.height=f;this.fixHeight(f)}k=null}else if(this.colCopy){A(this.dcol).addClass("thMove").removeClass("thOver");if(c.pageX>this.hset.right||c.pageX<this.hset.left||c.pageY>this.hset.bottom||c.pageY<this.hset.top){A("body").css("cursor","move")}else A("body").css("cursor","pointer");A(this.colCopy).css({top:c.pageY+10,left:c.pageX+20,display:"block"})}},dragEnd:function(){if(this.colresize){var Z=this.colresize.n,Y=this.colresize.nw;A("th:visible div:eq("+Z+")",this.hDiv).css("width",Y);A("tr",this.bDiv).each(function(){A("td:visible div:eq("+Z+")",this).css("width",Y)});this.hDiv.scrollLeft=this.bDiv.scrollLeft;A("div:eq("+Z+")",this.cDrag).siblings().show();A(".dragging",this.cDrag).removeClass("dragging");this.rePosDrag();this.colresize=false}else if(this.vresize){this.vresize=false}else if(this.colCopy){A(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt){A("th:eq("+this.dcolt+")",this.hDiv).before(this.dcol)}else A("th:eq("+this.dcolt+")",this.hDiv).after(this.dcol);this.switchCol(this.dcoln,this.dcolt);A(this.cdropleft).remove();A(this.cdropright).remove();this.rePosDrag()}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;A(".thMove",this.hDiv).removeClass("thMove");A(this.cDrag).show()}A("body").css("cursor","default");A("body").noSelect(false);if(ie9)this.ie9Fix()},toggleCol:function(c,a){var Z=A("th[axis='col"+c+"']",this.hDiv)[0],b=A("thead th",S.hDiv).index(Z),Y=A("input[value="+c+"]",S.nDiv)[0];if(a==null)a=Z.hide;if(A("input:checked",S.nDiv).length<P.minColToggle&&!a)return false;if(a){Z.hide=false;A(Z).show();Y.checked=true}else{Z.hide=true;A(Z).hide();Y.checked=false}A("tbody tr",N).each(function(){if(a){A("td:eq("+b+")",this).show()}else A("td:eq("+b+")",this).hide()});this.rePosDrag();if(P.onToggleCol)P.onToggleCol(c,a);return a},switchCol:function(Z,Y){A("tbody tr",N).each(function(){if(Z>Y){A("td:eq("+Y+")",this).before(A("td:eq("+Z+")",this))}else A("td:eq("+Y+")",this).after(A("td:eq("+Z+")",this))});if(Z>Y){A("tr:eq("+Y+")",this.nDiv).before(A("tr:eq("+Z+")",this.nDiv))}else A("tr:eq("+Y+")",this.nDiv).after(A("tr:eq("+Z+")",this.nDiv));if(A.browser.msie&&A.browser.version<7)A("tr:eq("+Y+") input",this.nDiv)[0].checked=true;this.hDiv.scrollLeft=this.bDiv.scrollLeft},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag()},addData:function(Z){A(".pReload",this.pDiv).removeClass("loading");this.loading=false;if(!Z){A(".pPageStat",this.pDiv).html(P.errorMsg);if(P.hideOnSubmit)A(S.block).remove();return false}var error=null;if(P.dataType=="xml"){error=+A("rows error",Z).text()||error;P.total=+A("rows total",Z).text()}else{error=Z.error||error;P.total=Z.total}if(error){if(A.isFunction(P.errorHandler)){P.errorHandler(error)}else A(".pPageStat",this.pDiv).html(error);if(P.hideOnSubmit)A(S.block).remove();return false}if(P.total==0){A("tr",N).unbind();A(N).empty();P.pages=1;P.page=1;this.buildpager();A(".pPageStat",this.pDiv).html(P.noFoundDataMsg);if(P.hideOnSubmit)A(S.block).remove();if(P.onSuccess)P.onSuccess();return false}P.pages=Math.ceil(P.total/P.limit);if(P.dataType=="xml"){P.page=+A("rows page",Z).text()}else P.page=Z.page;this.buildpager();var Y=document.createElement("tbody");if(P.dataType=="json"){A.each(Z.rows,function(a,c){var b=document.createElement("tr");if(a%2&&P.striped)b.className="erow";if(c.id)b.id="row"+c.id;A("thead tr:first th",S.hDiv).each(function(){var f=document.createElement("td"),e,showFullTitle;if(A.isArray(c.cell)){e=A(this).attr("axis").substr(3)}else e=A(this).attr("abbr");f.align=this.align;showFullTitle=A(this).attr("show_full_title");if(c.cell[e]!=null){f.innerHTML=c.cell[e];if(showFullTitle){var fulltitle=f.innerHTML,pos;pos=fulltitle.indexOf('<');if(pos!==-1)fulltitle=fulltitle.substr(0,pos);f.title=fulltitle}}A(b).append(f);f=null});if(A("thead",this.gDiv).length<1)for(idx=0;idx<c.cell.length;idx++){var d=document.createElement("td");d.innerHTML=c.cell[idx];A(b).append(d);d=null}A(Y).append(b);b=null})}else if(P.dataType=="xml"){i=1;A("rows row",Z).each(function(){i++;var b=document.createElement("tr");if(i%2&&P.striped)b.className="erow";var c=A(this).attr("id");if(c)b.id="row"+c;c=null;var a=this;A("thead tr:first th",S.hDiv).each(function(){var e=document.createElement("td"),d=A(this).attr("axis").substr(3);e.align=this.align;e.innerHTML=A("cell:eq("+d+")",a).text();A(b).append(e);e=null});if(A("thead",this.gDiv).length<1)A("cell",this).each(function(){var d=document.createElement("td");d.innerHTML=A(this).text();A(b).append(d);d=null});A(Y).append(b);b=null;a=null})}A("tr",N).unbind();A(N).empty();A(N).append(Y);A("thead tr").find(":checkbox[name=toggle]").click(function(){TG=this;var $boxChecked=$(":hidden[name=boxChecked]");$boxChecked.val(0);A("tbody tr",S.bDiv).each(function(){if($(this).find(":checkbox:first").prop("disabled")){return true}A(this).find(":checkbox:first").not(":disabled").prop("checked",TG.checked);var boxChecked=parseInt($boxChecked.val());if(TG.checked){A(this).addClass("trSelected");$boxChecked.val(boxChecked+1)}else{A(this).removeClass("trSelected")}})});this.addCellProp();this.addRowProp();this.fixHeight(A(this.bDiv).height());this.rePosDrag();Y=null;Z=null;i=null;if(P.onSuccess)P.onSuccess();if(P.hideOnSubmit)A(S.block).remove();this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(A.browser.opera)A(N).css("visibility","visible")},changeSort:function(Y){if(this.loading)return true;A(S.nDiv).hide();A(S.nBtn).hide();if(P.sortName==A(Y).attr("abbr"))if(P.sortOrder=="asc"){P.sortOrder="desc"}else P.sortOrder="asc";A(Y).addClass("sorted").siblings().removeClass("sorted");A(".sdesc",this.hDiv).removeClass("sdesc");A(".sasc",this.hDiv).removeClass("sasc");A("div",Y).addClass("s"+P.sortOrder);P.sortName=A(Y).attr("abbr");if(P.onChangeSort){P.onChangeSort(P.sortName,P.sortOrder)}else this.populate()},buildpager:function(){A(".pcontrol input").val(P.page);A(".pcontrol span").html(P.pages);var Z=(P.page-1)*P.limit+1,Y=Z+P.limit-1;if(P.total<Y)Y=P.total;var a=P.pageStat;a=a.replace(/\{from\}/,Z);a=a.replace(/\{to\}/,Y);a=a.replace(/\{total\}/,P.total);A(".pPageStat",this.pDiv).html(a)},populate:function(){if(this.loading)return true;if(P.onSubmit){var Z=P.onSubmit();if(!Z)return false}this.loading=true;if(!P.url)return false;A(".pPageStat",this.pDiv).html(P.processingMsg);A(".pReload",this.pDiv).addClass("loading");A(S.block).css({top:S.bDiv.offsetTop});if(P.hideOnSubmit)A(this.gDiv).prepend(S.block);if(A.browser.opera)A(N).css("visibility","hidden");if(!P.startPage)P.startPage=1;if(P.page>P.pages)P.page=P.pages;var a={page:P.startPage,limit:P.limit,sortName:P.sortName,sortOrder:P.sortOrder};if(P.searchItems){var SI={};for(var field in P.searchItems)if(typeof P[field]!=='undefined'&&P[field]!==null)SI[field]=P[field];A.extend(a,SI)}if(P.params){var Y={};A.each(P.params,function(){Y[this.name]=this.value});A.extend(a,Y)}loaded=true;var rowNumber;if(P.rowNumbers)rowNumber=(P.startPage-1)*P.limit+1;A.ajax({type:P.method,url:P.url,data:a,dataType:P.dataType,success:function(b){if(typeof b.status!='undefined'&&!b.status){if(b.redirectUrl){window.location.href=b.redirectUrl}else if(b.message)A(".pPageStat",this.pDiv).html(b.message);A(".pReload",S.pDiv).removeClass("loading");S.loading=false}else{if(P.rowNumbers){var m;for(m in b.rows)b.rows[m].cell.rowNumber=rowNumber++}S.addData(b)}}})},doSearch:function(clear){clear=clear||false;if(P.searchItems)for(var field in P.searchItems){if(clear)P[field]=P.searchItems[field]['default']||'';switch(P.searchItems[field]['type']){case'hidden':if(clear){A(":hidden[name='"+field+"']").val(P[field])}else P[field]=A(":hidden[name='"+field+"']").val();break;case'text':if(clear){A(":text[name='"+field+"']").val(P[field])}else P[field]=A(":text[name='"+field+"']").val();break;case'radio':if(clear){A(":radio[name='"+field+"']").attr('checked',false);if(P[field])A(":radio[value='"+P[field]+"']").attr('checked',true)}else P[field]=A(":radio:checked[name='"+field+"']").val();break;case'checkbox':if(clear){A(":checkbox[name='"+field+"']").attr('checked',false);if(P[field])A(":checkbox[value='"+P[field]+"']").attr('checked',true)}else if(field.indexOf('[')==-1){P[field]=A(":checkbox:checked[name='"+field+"']").val()}else{var data=[];A(":checkbox:checked[name='"+field+"']").each(function(i,e){data.push(A(this).val())});if(data.length>0)P[field]=data}break;case'select':if(clear){if(P[field]){A("select[name='"+field+"']").val(P[field])}else A("select[name='"+field+"']").get(0).selectedIndex=0}else P[field]=A("select[name='"+field+"'] option:selected").val();break}}if(loaded)P.startPage=1;this.populate()},changePage:function(Z){if(this.loading)return true;switch(Z){case"first":P.startPage=1;break;case"prev":if(P.page>1)P.startPage=P.page-1;break;case"next":if(P.page<P.pages)P.startPage=parseInt(P.page)+1;break;case"last":P.startPage=P.pages;break;case"input":var Y=parseInt(A(".pcontrol input").val());if(isNaN(Y))Y=1;if(Y<1){Y=1}else if(Y>P.pages)Y=P.pages;A(".pcontrol input").val(Y);P.startPage=Y;break}if(P.startPage==P.page)return false;if(P.onChangePage){P.onChangePage(P.startPage)}else this.populate()},addCellProp:function(){A("tbody tr td",S.bDiv).each(function(){var a=document.createElement("div"),c=A("td",A(this).parent()).index(this),b=A("th:eq("+c+")",S.hDiv).get(0);if(b!=null){if(P.sortName==A(b).attr("abbr")&&P.sortName)this.className="sorted";A(a).css({textAlign:b.align,width:A("div:first",b)[0].style.width});if(b.hide)A(this).css("display","none")}if(P.nowrap==false)A(a).css("white-space","normal");if(this.innerHTML=="")this.innerHTML=" ";a.innerHTML=this.innerHTML;var Z=A(this).parent()[0],Y=false;if(Z.id)Y=Z.id.substr(3);if(b!=null)if(b.process)b.process(a,Y);A(this).empty().append(a).removeAttr("width")})},getCellDim:function(a){var e=parseInt(A(a).height()),Y=parseInt(A(a).parent().height()),c=parseInt(a.style.width),g=parseInt(A(a).parent().width()),d=a.offsetParent.offsetTop,Z=a.offsetParent.offsetLeft,f=parseInt(A(a).css("paddingLeft")),b=parseInt(A(a).css("paddingTop"));return{ht:e,wt:c,top:d,left:Z,pdl:f,pdt:b,pht:Y,pwt:g}},addRowProp:function(){A("tbody tr",S.bDiv).each(function(){var TG_checkbox=A(this).find(":checkbox:first"),TG_disabled=TG_checkbox.attr("disabled");A(this).click(function(Z){var Y=(Z.target||Z.srcElement);if(Y.href||Y.type)return true;if(!TG_disabled){var $boxChecked=$(":hidden[name=boxChecked]");var TG_checked=TG_checkbox.attr("checked"),boxChecked_nums=parseInt($boxChecked.val());if(TG_checked){$boxChecked.val(boxChecked_nums-1)}else{$boxChecked.val(boxChecked_nums+1)}A(this).toggleClass("trSelected").find(":checkbox").attr("checked",!TG_checked)}}).mousedown(function(Y){if(!TG_disabled)if(Y.shiftKey){A(this).toggleClass("trSelected");S.multisel=true;this.focus();A(S.gDiv).noSelect()}}).mouseup(function(){if(S.multisel){S.multisel=false;A(S.gDiv).noSelect(false)}}).mouseleave(function(){if(ie9)this.ie9Fix()}).hover(function(Y){if(!TG_disabled)if(S.multisel)A(this).toggleClass("trSelected")},function(){});if(A.browser.msie&&A.browser.version<7)A(this).hover(function(){if(!TG_disabled)A(this).addClass("trOver")},function(){A(this).removeClass("trOver")})})},pager:0};S.gDiv=document.createElement("div");S.mDiv=document.createElement("div");S.hDiv=document.createElement("div");S.bDiv=document.createElement("div");S.vDiv=document.createElement("div");S.rDiv=document.createElement("div");S.cDrag=document.createElement("div");S.block=document.createElement("div");S.nDiv=document.createElement("div");S.nBtn=document.createElement("div");S.iDiv=document.createElement("div");S.tDiv=document.createElement("div");S.sDiv=document.createElement("div");if(P.usePager)S.pDiv=document.createElement("div");S.hTable=document.createElement("table");S.gDiv.className="flexigrid";if(P.width!="auto")S.gDiv.style.width=P.width;if(A.browser.msie)A(S.gDiv).addClass("ie");if(P.novStripe)A(S.gDiv).addClass("novstripe");A(N).before(S.gDiv);A(S.gDiv).append(N);if(P.colModel){if(P.rowNumbers){var rowNumberColumn={align:"center",display:"",enableToggle:false,hide:false,name:'rowNumber',showFullTitle:false,sortable:false,width:20};P.colModel.unshift(rowNumberColumn)}if(P.fitColumns){var totalWidth=0,k,gDivWidth=A(S.gDiv).width(),maxColumnNumber=P.colModel.length;for(k in P.colModel)totalWidth+=(P.colModel[k].width||0)+padding;var rate=Math.floor(gDivWidth/ totalWidth * 100) /100,curTotalWidth=0,colWidth,columnIndex=0;for(k in P.colModel){colWidth=P.colModel[k].width*rate;columnIndex++;if(maxColumnNumber==columnIndex){colWidth=gDivWidth-curTotalWidth-padding-3}else curTotalWidth+=colWidth+padding;P.colModel[k].width=colWidth}}T=document.createElement("thead");var tr=document.createElement("tr");for(i in P.colModel){var K=P.colModel[i],H=document.createElement("th");H.innerHTML=K.display;if(K.name)A(H).attr("abbr",K.name);if(K.showFullTitle)A(H).attr("show_full_title",K.showFullTitle);A(H).attr("axis","col"+i);if(K.align)H.align=K.align;if(K.width)A(H).attr("width",K.width);if(K.hide)H.hide=true;if(K.sortable==false){A(H).attr("sortable",false)}else A(H).attr("sortable",true);if(K.enableToggle==false){A(H).attr("enableToggle",false)}else A(H).attr("enableToggle",true);if(K.process)H.process=K.process;A(tr).append(H)}A(T).append(tr);A(N).prepend(T)}if(P.buttons){S.tDiv.className="tDiv";var V=document.createElement("div");V.className="tDiv2";for(i in P.buttons){var J=P.buttons[i];if(!J.separator){var R=document.createElement("div");R.className="fbutton";R.name=J.name,R.innerHTML="<div><span>"+J.title+"</span></div>";if(J.buttonClass)A("span",R).addClass(J.buttonClass).css({paddingLeft:20});if(J.description)A("span",R).attr('title',J.description);R.onPress=J.onPress;R.name=J.name;if(J.onPress)A(R).click(function(){this.onPress(this.name,S.gDiv)});A(V).append(R);if(A.browser.msie&&A.browser.version<7)A(R).hover(function(){A(this).addClass("fbOver")},function(){A(this).removeClass("fbOver")})}else A(V).append("<div class='btnseparator'></div>")}A(S.tDiv).append(V);A(S.tDiv).append("<div style='clear:both'></div>");A(S.gDiv).prepend(S.tDiv)}S.hDiv.className="hDiv";A(N).before(S.hDiv);S.hTable.cellPadding=0;S.hTable.cellSpacing=0;A(S.hDiv).append('<div class="hDivBox"></div>');A("div",S.hDiv).append(S.hTable);var T=A("thead:first",N).get(0);if(T)A(S.hTable).append(T);T=null;if(!P.colmodel)var L=0;A("thead tr:first th",S.hDiv).each(function(){var Y=document.createElement("div");if(A(this).attr("sortable")=="true"&&A(this).attr("abbr")){A(this).click(function(a){if(!A(this).hasClass("thOver"))return false;var Z=(a.target||a.srcElement);if(Z.href||Z.type)return true;S.changeSort(this)});if(A(this).attr("abbr")==P.sortName){this.className="sorted";Y.className="s"+P.sortOrder}}if(this.hide)A(this).hide();if(!P.colmodel)A(this).attr("axis","col"+L++);A(Y).css({textAlign:this.align,width:this.width+"px"});Y.innerHTML=this.innerHTML;A(this).empty().append(Y).removeAttr("width");if(A(this).attr("sortable")=="true"){A(this).mousedown(function(Z){S.dragStart("colMove",Z,this)});A(this).hover(function(){if(!S.colresize&&!A(this).hasClass("thMove")&&!S.colCopy)A(this).addClass("thOver");if(A(this).attr("abbr")!=P.sortName&&!S.colCopy&&!S.colresize&&A(this).attr("abbr")){A("div",this).addClass("s"+P.sortOrder)}else if(A(this).attr("abbr")==P.sortName&&!S.colCopy&&!S.colresize&&A(this).attr("abbr")){var d="";if(P.sortOrder=="asc"){d="desc"}else d="asc";A("div",this).removeClass("s"+P.sortOrder).addClass("s"+d)}if(S.colCopy){var e=A("th",S.hDiv).index(this);if(e==S.dcoln)return false;if(e<S.dcoln){A(this).append(S.cdropleft)}else A(this).append(S.cdropright);S.dcolt=e}else if(!S.colresize){var a=A("th:visible",S.hDiv).index(this),c=parseInt(A("div:eq("+a+")",S.cDrag).css("left")),Z=parseInt(A(S.nBtn).width())+parseInt(A(S.nBtn).css("borderLeftWidth"));nl=c-Z+Math.floor(P.cgwidth/2);if(isNaN(nl))nl=0;A(S.nDiv).hide();A(S.nBtn).hide();A(S.nBtn).css({left:nl,top:S.hDiv.offsetTop}).show();var b=parseInt(A(S.nDiv).width());A(S.nDiv).css({top:S.bDiv.offsetTop});if((nl+b)>A(S.gDiv).width()){A(S.nDiv).css("left",c-b+1)}else A(S.nDiv).css("left",nl);if(A(this).hasClass("sorted")){A(S.nBtn).addClass("srtd")}else A(S.nBtn).removeClass("srtd")}},function(){A(this).removeClass("thOver");if(A(this).attr("abbr")!=P.sortName){A("div",this).removeClass("s"+P.sortOrder)}else if(A(this).attr("abbr")==P.sortName){var Z="";if(P.sortOrder=="asc"){Z="desc"}else Z="asc";A("div",this).addClass("s"+P.sortOrder).removeClass("s"+Z)}if(S.colCopy){A(S.cdropleft).remove();A(S.cdropright).remove();S.dcolt=null}})}});S.bDiv.className="bDiv";A(N).before(S.bDiv);A(S.bDiv).css({height:(P.height=="auto")?"auto":P.height+"px"}).scroll(function(Y){S.scroll()}).append(N);if(P.height=="auto")A("table",S.bDiv).addClass("autoht");S.addCellProp();S.addRowProp();var G=A("thead tr:first th:first",S.hDiv).get(0);if(G!=null){S.cDrag.className="cDrag";S.cdpad=11;A(S.bDiv).before(S.cDrag);var D=A(S.bDiv).height(),C=A(S.hDiv).height();A(S.cDrag).css({top:-C+"px"});A("thead tr:first th",S.hDiv).each(function(){var Y=document.createElement("div");A(S.cDrag).append(Y);if(!P.cgwidth)P.cgwidth=A(Y).width();A(Y).css({height:D+C}).mousedown(function(Z){S.dragStart("colresize",Z,this)});if(A.browser.msie&&A.browser.version<7){S.fixHeight(A(S.gDiv).height());A(Y).hover(function(){S.fixHeight();A(this).addClass("dragging")},function(){if(!S.colresize)A(this).removeClass("dragging")})}});S.rePosDrag()}if(P.striped)A("tbody tr:odd",S.bDiv).addClass("erow");if(P.resizable&&P.height!="auto"){S.vDiv.className="vGrip";A(S.vDiv).mousedown(function(Y){S.dragStart("vresize",Y)}).html("<span></span>");A(S.bDiv).after(S.vDiv)}if(P.resizable&&P.width!="auto"){S.rDiv.className="hGrip";A(S.rDiv).mousedown(function(Y){S.dragStart("vresize",Y,true)}).html("<span></span>").css("height",A(S.gDiv).height());if(A.browser.msie&&A.browser.version<7)A(S.rDiv).hover(function(){A(this).addClass("hgOver")},function(){A(this).removeClass("hgOver")});A(S.gDiv).append(S.rDiv)}if(P.usePager){S.pDiv.className="pDiv";S.pDiv.innerHTML='<div class="pDiv2"></div>';A(S.bDiv).after(S.pDiv);var Q=P.pageText;Q=Q.replace(/\{currentPage\}/,'<input type="text" size="4" value="1" class="form-text-small"/>');Q=Q.replace(/\{totalPage\}/,"<span> 1 </span>");var M=' <div class="pGroup"> <div class="pFirst pButton"><span></span></div><div class="pPrev pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pcontrol">'+Q+'</span></div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pNext pButton"><span></span></div><div class="pLast pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pReload pButton"><span title="'+P.refreshText+'"></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pPageStat"></span></div>';A("div",S.pDiv).html(M);A(".pReload",S.pDiv).click(function(){S.populate()});A(".pFirst",S.pDiv).click(function(){S.changePage("first")});A(".pPrev",S.pDiv).click(function(){S.changePage("prev")});A(".pNext",S.pDiv).click(function(){S.changePage("next")});A(".pLast",S.pDiv).click(function(){S.changePage("last")});A(".pcontrol input",S.pDiv).keydown(function(Y){if(Y.keyCode==13)S.changePage("input")});if(A.browser.msie&&A.browser.version<7)A(".pButton",S.pDiv).hover(function(){A(this).addClass("pBtnOver")},function(){A(this).removeClass("pBtnOver")});if(P.useRp){var E="";for(var W in P.limitOptions){if(P.limit==P.limitOptions[W]){sel='selected="selected"'}else sel="";E+="<option value='"+P.limitOptions[W]+"' "+sel+" >"+P.limitOptions[W]+"  </option>"}A(".pDiv2",S.pDiv).prepend("<div class='pGroup'><select name='limit' class='form-select-small'>"+E+"</select></div> <div class='btnseparator'></div>");A("select",S.pDiv).change(function(){if(P.onRpChange){P.onRpChange(+this.value)}else{P.startPage=1;P.limit=+this.value;S.populate()}})}if(P.searchItems){A(".pDiv2",S.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");A(".pSearch",S.spDiv).click(function(){A(S.sDiv).slideToggle("fast",function(){A(".sDiv:visible input:first",S.gDiv).trigger("focus")})});S.sDiv.className="sDiv";if(P.showSearchBar)S.sDiv.style.display="block";var F=" ";for(var field in P.searchItems)F+=" "+P.searchItems[field]['html'];var searchHtml="<div class='sDiv2'>"+P.quickSearchText+F+" <input type='button' name='startSearch' id='startSearchButton' value='"+P.searchText+"'/>";if(!P.disableClearSearchButton)searchHtml+="<input type='button' name='clear' id='clearSearchButton' value='"+P.clearText+"' />";if(P.attachButtons){var ButtonHtml='';for(var key in P.attachButtons)ButtonHtml+=" "+P.attachButtons[key];searchHtml+=ButtonHtml}searchHtml+='</div>';A(S.sDiv).append(searchHtml);A("input[name=startSearch]",S.sDiv).click(function(){S.doSearch()});if(!P.disableClearSearchButton)A("input[name=clear]",S.sDiv).click(function(){S.doSearch(true)});A(S.bDiv).after(S.sDiv)}if($.isFunction(P.onLoad))P.onLoad()}A(S.pDiv,S.sDiv).append("<div style='clear:both'></div>");if(P.title){S.mDiv.className="mDiv";S.mDiv.innerHTML='<div class="ftitle">'+P.title+"</div>";A(S.gDiv).prepend(S.mDiv);if(P.showTableToggleBtn){A(S.mDiv).append('<div class="ptogtitle" title="Minimize/Maximize Table"><span></span></div>');A("div.ptogtitle",S.mDiv).click(function(){A(S.gDiv).toggleClass("hideBody");A(this).toggleClass("vsble")})}}S.cdropleft=document.createElement("span");S.cdropleft.className="cdropleft";S.cdropright=document.createElement("span");S.cdropright.className="cdropright";S.block.className="gBlock";var U=A(S.bDiv).height(),X=S.bDiv.offsetTop;A(S.block).css({width:S.bDiv.style.width,height:U,background:"white",position:"relative",marginBottom:(U*-1),zIndex:999,top:X,left:"0px"});A(S.block).fadeTo(0,P.blockOpacity);if(A("th",S.hDiv).length){S.nDiv.className="nDiv";S.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";A(S.nDiv).css({marginBottom:(U*-1),display:"none",top:X}).noSelect();var I=0;A("th div",S.hDiv).each(function(){var Z=A("th[axis='col"+I+"']",S.hDiv)[0],enableToggle=A(this).parent().attr('enableToggle');if(enableToggle=='true'){var Y='checked="checked"';if(Z.style.display=="none")Y="";A("tbody",S.nDiv).append('<tr><td class="ndcol1"><input type="checkbox" '+Y+' class="togCol" value="'+I+'" /></td><td class="ndcol2">'+this.innerHTML+"</td></tr>")}I++});if(A.browser.msie&&A.browser.version<7)A("tr",S.nDiv).hover(function(){A(this).addClass("ndcolover")},function(){A(this).removeClass("ndcolover")});A("td.ndcol2",S.nDiv).click(function(){if(A("input:checked",S.nDiv).length<=P.minColToggle&&A(this).prev().find("input")[0].checked)return false;return S.toggleCol(A(this).prev().find("input").val())});A("input.togCol",S.nDiv).click(function(){if(A("input:checked",S.nDiv).length<P.minColToggle&&this.checked==false)return false;A(this).parent().next().trigger("click")});A(S.gDiv).prepend(S.nDiv);A(S.nBtn).addClass("nBtn").html("<div></div>").attr("title","Hide/Show Columns").css("top",S.hDiv.offsetTop).click(function(){A(S.nDiv).toggle();return true});if(P.showToggleBtn)A(S.gDiv).prepend(S.nBtn)}A(S.iDiv).addClass("iDiv").css({display:"none"});A(S.bDiv).append(S.iDiv);A(S.bDiv).hover(function(){A(S.nDiv).hide();A(S.nBtn).hide()},function(){if(S.multisel)S.multisel=false});A(S.gDiv).hover(function(){},function(){A(S.nDiv).hide();A(S.nBtn).hide()});A(document).mousemove(function(Y){S.dragMove(Y)}).mouseup(function(Y){S.dragEnd()}).hover(function(){},function(){S.dragEnd()});if(A.browser.msie&&A.browser.version<7){A(".hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv",S.gDiv).css({width:"100%"});A(S.gDiv).addClass("ie6");if(P.width!="auto")A(S.gDiv).addClass("ie6fullwidthbug")}N.p=P;N.grid=S;if(P.url)if(P.autoload)if(P.showSearchBar){S.doSearch()}else S.populate();return N};var B=false;A(document).ready(function(){B=true});A.fn.flexigrid=function(C){return this.each(function(){if(!B){A(this).hide();var D=this;A(document).ready(function(){A.addFlex(D,C)})}else A.addFlex(this,C)})};A.fn.flexReload=function(C){return this.each(function(){if(this.grid&&this.p.url)this.grid.populate()})};A.fn.flexOptions=function(C){return this.each(function(){if(this.grid)A.extend(this.p,C)})};A.fn.flexToggleCol=function(D,C){return this.each(function(){if(this.grid)this.grid.toggleCol(D,C)})};A.fn.noSelect=function(C){if(C==null){prevent=true}else prevent=C;if(prevent){return this.each(function(){if(A.browser.msie||A.browser.safari){A(this).bind("selectstart",function(){return false})}else if(A.browser.mozilla){A(this).css("MozUserSelect","none");A("body").trigger("focus")}else if(A.browser.opera){A(this).bind("mousedown",function(){return false})}else A(this).attr("unselectable","on")})}else return this.each(function(){if(A.browser.msie||A.browser.safari){A(this).unbind("selectstart")}else if(A.browser.mozilla){A(this).css("MozUserSelect","inherit")}else if(A.browser.opera){A(this).unbind("mousedown")}else A(this).removeAttr("unselectable","on")})}})(jQuery);